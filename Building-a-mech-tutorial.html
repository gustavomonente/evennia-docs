<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="img/favicon.ico">
        <title>Building a mech tutorial - Evennia Manual</title>
        <link href="css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="css/font-awesome.min.css" rel="stylesheet">
        <link href="css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="js/jquery-1.10.2.min.js" defer></script>
        <script src="js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="index.html">Evennia Manual</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="index.html">Home</a>
                            </li>
                            <li >
                                <a href="Administrative-Docs.html">Admin</a>
                            </li>
                            <li >
                                <a href="Builder-Docs.html">Building</a>
                            </li>
                            <li >
                                <a href="Developer-Central.html">Game Development</a>
                            </li>
                            <li >
                                <a href="Tutorials.html">Tutorials</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#creating-the-mech">Creating the Mech</a></li>
            <li><a href="#arming-the-mech">Arming the Mech</a></li>
        <li class="main "><a href="#making-a-mech-production-line">Making a Mech production line</a></li>
        <li class="main "><a href="#future-mechs">Future Mechs</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h2 id="creating-the-mech">Creating the Mech<a class="headerlink" href="#creating-the-mech" title="Permanent link">&para;</a></h2>
<p>Let us create a functioning giant mech using the Python MUD-creation system Evennia. Everyone likes a giant mech, right? Start in-game as a character with build privileges (or the superuser).</p>
<pre><code>@create/drop Giant Mech ; mech
</code></pre>
<p>Boom. We created a Giant Mech Object and dropped it in the room. We also gave it an alias <em>mech</em>. Let’s describe it.</p>
<pre><code>@desc mech = This is a huge mech. It has missiles and stuff.
</code></pre>
<p>Next we define who can “puppet” the mech object.</p>
<pre><code>@lock mech = puppet:all()
</code></pre>
<p>This makes it so that everyone can control the mech. More mechs to the people! (Note that whereas Evennia’s default commands may look vaguely MUX-like, you can change the syntax to look like whatever interface style you prefer.)</p>
<p>Before we continue, let’s make a brief detour. Evennia is very flexible about its objects and even more flexible about using and adding commands to those objects. Here are some ground rules well worth remembering for the remainder of this article:</p>
<ul>
<li>The <a href="Accounts.html">Account</a> represents the real person logging in and has no game-world existence.</li>
<li>Any <a href="Objects.html">Object</a> can be puppeted by an Account (with proper permissions).</li>
<li><a href="Objects#characters">Characters</a>, <a href="Objects#rooms">Rooms</a>, and <a href="Objects#exits">Exits</a> are just children of normal Objects.</li>
<li>Any Object can be inside another (except if it creates a loop).</li>
<li>Any Object can store custom sets of commands on it. Those commands can:<ul>
<li>be made available to the puppeteer (Account),</li>
<li>be made available to anyone in the same location as the Object, and</li>
<li>be made available to anyone “inside” the Object</li>
<li>Also Accounts can store commands on themselves. Account commands are always available unless commands on a puppeted Object explicitly override them.</li>
</ul>
</li>
</ul>
<p>In Evennia, using the <code>@ic</code> command will allow you to puppet a given Object (assuming you have puppet-access to do so). As mentioned above, the bog-standard Character class is in fact like any Object: it is auto-puppeted when logging in and just has a command set on it containing the normal in-game commands, like look, inventory, get and so on.</p>
<pre><code>@ic mech
</code></pre>
<p>You just jumped out of your Character and <em>are</em> now the mech! If people look at you in-game, they will look at a mech. The problem at this point is that the mech Object has no commands of its own. The usual things like look, inventory and get sat on the Character object, remember? So at the moment the mech is not quite as cool as it could be.</p>
<pre><code>@ic &lt;Your old Character&gt;
</code></pre>
<p>You just jumped back to puppeting your normal, mundane Character again. All is well.</p>
<blockquote>
<p>(But, you ask, where did that <code>@ic</code> command come from, if the mech had no commands on it? The answer is that it came from the Account's command set. This is important. Without the Account being the one with the <code>@ic</code> command, we would not have been able to get back out of our mech again.)</p>
</blockquote>
<h3 id="arming-the-mech">Arming the Mech<a class="headerlink" href="#arming-the-mech" title="Permanent link">&para;</a></h3>
<p>Let us make the mech a little more interesting. In our favorite text editor, we will create some new mech-suitable commands. In Evennia, commands are defined as Python classes.</p>
<pre><code class="python"># in a new file mygame/commands/mechcommands.py

from evennia import Command

class CmdShoot(Command):
    &quot;&quot;&quot;
    Firing the mech’s gun

    Usage:
      shoot [target]

    This will fire your mech’s main gun. If no
    target is given, you will shoot in the air.
    &quot;&quot;&quot;
    key = &quot;shoot&quot;
    aliases = [&quot;fire&quot;, &quot;fire!&quot;]

    def func(self):
        &quot;This actually does the shooting&quot;

        caller = self.caller
        location = caller.location

        if not self.args:
            # no argument given to command - shoot in the air
            message = “BOOM! The mech fires its gun in the air!”
            location.msg_contents(message)
            return

        # we have an argument, search for target
        target = caller.search(self.args)
        if target:
            message = &quot;BOOM! The mech fires its gun at %s&quot; % target.key
            location.msg_contents(message)

class CmdLaunch(Command):
    # make your own 'launch'-command here as an exercise!
    # (it's very similar to the 'shoot' command above).
</code></pre>

<p>This is saved as a normal Python module (let’s call it <code>mechcommands.py</code>), in a place Evennia looks for such modules (<code>mygame/commands/</code>). This command will trigger when the player gives the command “shoot”, “fire,” or even “fire!” with an exclamation mark. The mech can shoot in the air or at a target if you give one. In a real game the gun would probably be given a chance to hit and give damage to the target, but this is enough for now.</p>
<p>We also make a second command for launching missiles (<code>CmdLaunch</code>). To save
space we won’t describe it here; it looks the same except it returns a text
about the missiles being fired and has different <code>key</code> and <code>aliases</code>. We leave
that up to you to create as an exercise. You could have it print "WOOSH! The
mech launches missiles against <target>!", for example.</p>
<p>Now we shove our commands into a command set. A <a href="Command-Sets.html">Command Set</a> (CmdSet) is a container holding any number of commands. The command set is what we will store on the mech.</p>
<pre><code class="python"># in the same file mygame/commands/mechcommands.py

from evennia import CmdSet
from evennia import default_cmds

class MechCmdSet(CmdSet):
    &quot;&quot;&quot;
    This allows mechs to do do mech stuff.
    &quot;&quot;&quot;
    key = &quot;mechcmdset&quot;

    def at_cmdset_creation(self):
        &quot;Called once, when cmdset is first created&quot;
        self.add(CmdShoot())
        self.add(CmdLaunch())
</code></pre>

<p>This simply groups all the commands we want. We add our new shoot/launch commands. Let’s head back into the game. For testing we will manually attach our new CmdSet to the mech.</p>
<pre><code>@py self.search("mech").cmdset.add("commands.mechcommands.MechCmdSet")
</code></pre>
<p>This is a little Python snippet (run from the command line as an admin) that searches for the mech in our current location and attaches our new MechCmdSet to it. What we add is actually the Python path to our cmdset class. Evennia will import and initialize it behind the scenes.</p>
<pre><code>@ic mech
</code></pre>
<p>We are back as the mech! Let’s do some shooting!</p>
<pre><code>fire!
BOOM! The mech fires its gun in the air!
</code></pre>
<p>There we go, one functioning mech. Try your own <code>launch</code> command and see that it works too. We can not only walk around as the mech — since the CharacterCmdSet is included in our MechCmdSet, the mech can also do everything a Character could do, like look around, pick up stuff, and have an inventory. We could now shoot the gun at a target or try the missile launch command. Once you have your own mech, what else do you need?</p>
<blockquote>
<p>Note: You'll find that the mech's commands are available to you by just standing in the same location (not just by puppeting it). We'll solve this with a <em>lock</em> in the next section.</p>
</blockquote>
<h2 id="making-a-mech-production-line">Making a Mech production line<a class="headerlink" href="#making-a-mech-production-line" title="Permanent link">&para;</a></h2>
<p>What we’ve done so far is just to make a normal Object, describe it and put some commands on it. This is great for testing. The way we added it, the MechCmdSet will even go away if we reload the server. Now we want to make the mech an actual object “type” so we can create mechs without those extra steps. For this we need to create a new Typeclass.</p>
<p>A <a href="Typeclasses.html">Typeclass</a> is a near-normal Python class that stores its existence to the database behind the scenes. A Typeclass is created in a normal Python source file:</p>
<pre><code class="python"># in the new file mygame/typeclasses/mech.py

from typeclasses.objects import Object
from commands.mechcommands import MechCmdSet
from evennia import default_cmds

class Mech(Object):
    &quot;&quot;&quot;
    This typeclass describes an armed Mech.
    &quot;&quot;&quot;
    def at_object_creation(self):
        &quot;This is called only when object is first created&quot;
        self.cmdset.add_default(default_cmds.CharacterCmdSet)
        self.cmdset.add(MechCmdSet, permanent=True)
        self.locks.add(&quot;puppet:all();call:false()&quot;)
        self.db.desc = &quot;This is a huge mech. It has missiles and stuff.&quot;
</code></pre>

<p>For convenience we include the full contents of the default <code>CharacterCmdSet</code> in there. This will make a Character’s normal commands available to the mech. We also add the mech-commands from before, making sure they are stored persistently in the database. The locks specify that anyone can puppet the meck and no-one can "call" the mech's Commands from 'outside' it - you have to puppet it to be able to shoot.</p>
<p>That’s it. When Objects of this type are created, they will always start out with the mech’s command set and the correct lock. We set a default description, but you would probably change this with <code>@desc</code> to individualize your mechs as you build them.</p>
<p>Back in the game, just exit the old mech (<code>@ic</code> back to your old character) then do</p>
<pre><code>@create/drop The Bigger Mech ; bigmech : mech.Mech
</code></pre>
<p>We create a new, bigger mech with an alias bigmech. Note how we give the python-path to our Typeclass at the end — this tells Evennia to create the new object based on that class (we don't have to give the full path in our game dir <code>typeclasses.mech.Mech</code> because Evennia knows to look in the <code>typeclasses</code> folder already). A shining new mech will appear in the room! Just use</p>
<pre><code>@ic bigmech
</code></pre>
<p>to take it on a test drive.</p>
<h2 id="future-mechs">Future Mechs<a class="headerlink" href="#future-mechs" title="Permanent link">&para;</a></h2>
<p>To expand on this you could add more commands to the mech and remove others. Maybe the mech shouldn’t work just like a Character after all. Maybe it makes loud noises every time it passes from room to room. Maybe it cannot pick up things without crushing them. Maybe it needs fuel, ammo and repairs. Maybe you’ll lock it down so it can only be puppeted by emo teenagers.</p>
<p>Having you puppet the mech-object directly is also just one way to implement a giant mech in Evennia.</p>
<p>For example, you could instead picture a mech as a “vehicle” that you “enter” as your normal  Character (since any Object can move inside another). In that case the “insides” of the mech Object could be the “cockpit”. The cockpit would have the <code>MechCommandSet</code> stored on itself and all the shooting goodness would be made available to you only when you enter it.</p>
<p>And of course you could put more guns on it. And make it fly.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = ".",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="js/base.js" defer></script>
        <script src="search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>

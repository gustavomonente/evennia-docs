<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="img/favicon.ico">
        <title>Signals - Evennia Manual</title>
        <link href="css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="css/font-awesome.min.css" rel="stylesheet">
        <link href="css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="js/jquery-1.10.2.min.js" defer></script>
        <script src="js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="index.html">Evennia Manual</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="index.html">Home</a>
                            </li>
                            <li >
                                <a href="Administrative-Docs.html">Admin</a>
                            </li>
                            <li >
                                <a href="Builder-Docs.html">Building</a>
                            </li>
                            <li >
                                <a href="Developer-Central.html">Game Development</a>
                            </li>
                            <li >
                                <a href="Tutorials.html">Tutorials</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#attaching-a-handler-to-a-signal">Attaching a handler to a signal</a></li>
        <li class="main "><a href="#available-signals">Available signals</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<p><a href="Signals-fired-at-particular-times"></a></p>
<p><em>This is feature available from evennia 0.9 and onward</em>.</p>
<p>There are multiple ways for you to plug in your own functionality into Evennia.
The most common way to do so is through <em>hooks</em> - methods on typeclasses that
gets called at particular events. Hooks are great when you want a game entity
to behave a certain way when something happens to it. <em>Signals</em> complements
hooks for cases when you want to easily attach new functionality without
overriding things on the typeclass.</p>
<p>When certain events happen in Evennia, a <em>Signal</em> is fired. The idea is that
you can "attach" any number of event-handlers to these signals. You can attach
any number of handlers and they'll all fire whenever any entity triggers the
signal.</p>
<p>Evennia uses the <a href="https://docs.djangoproject.com/en/2.2/topics/signals/">Django Signal system</a>.</p>
<h2 id="attaching-a-handler-to-a-signal">Attaching a handler to a signal<a class="headerlink" href="#attaching-a-handler-to-a-signal" title="Permanent link">&para;</a></h2>
<p>First you create your handler</p>
<pre><code class="python">
def myhandler(sender, **kwargs):
  # do stuff

</code></pre>

<p>The <code>**kwargs</code> is mandatory. Then you attach it to the signal of your choice:</p>
<pre><code class="python">from evennia.server import signals

signals.SIGNAL_OBJECT_POST_CREATE.connect(myhandler)

</code></pre>

<p>This particular signal fires after (post) an Account has connected to the game.
When that happens, <code>myhandler</code> will fire with the <code>sender</code> being the Account that just connected.</p>
<p>If you want to respond only to the effects of a specific entity you can do so
like this:</p>
<pre><code class="python">from evennia import search_account
from evennia import signals

account = search_account(&quot;foo&quot;)[0]
signals.SIGNAL_ACCOUNT_POST_CONNECT.connect(myhandler, account)
</code></pre>

<h2 id="available-signals">Available signals<a class="headerlink" href="#available-signals" title="Permanent link">&para;</a></h2>
<p>All signals (including some django-specific defaults) are available in the module <code>evennia.server.signals</code>
(with a shortcut <code>evennia.signals</code>). Signals are named by the sender type. So <code>SIGNAL_ACCOUNT_*</code> returns
<code>Account</code> instances as senders, <code>SIGNAL_OBJECT_*</code> returns <code>Object</code>s etc. Extra keywords (kwargs) should
be extracted from the <code>**kwargs</code> dict in the signal handler.</p>
<ul>
<li><code>SIGNAL_ACCOUNT_POST_CREATE</code> - this is triggered at the very end of <code>Account.create()</code>. Note that
  calling <code>evennia.create.create_account</code> (which is called internally by <code>Account.create</code>) will <em>not</em>
  trigger this signal. This is because using <code>Account.create()</code> is expected to be the most commonly
  used way for users to themselves create accounts during login. It passes and extra kwarg <code>ip</code> with
  the client IP of the connecting account.</li>
<li><code>SIGNAL_ACCOUNT_POST_LOGIN</code> - this will always fire when the account has authenticated.  Sends
  extra kwarg <code>session</code> with the new <a href="Sessions.html">Session</a> object involved.</li>
<li><code>SIGNAL_ACCCOUNT_POST_FIRST_LOGIN</code> - this fires just before <code>SIGNAL_ACCOUNT_POST_LOGIN</code> but only if
  this is the <em>first</em> connection done (that is, if there are no previous sessions connected). Also
  passes the <code>session</code> along as a kwarg.</li>
<li><code>SIGNAL_ACCOUNT_POST_LOGIN_FAIL</code> - sent when someone tried to log into an account by failed. Passes
  the <code>session</code> as an extra kwarg.</li>
<li><code>SIGNAL_ACCOUNT_POST_LOGOUT</code> - always fires when an account logs off, no matter if other sessions
  remain or not. Passes the disconnecting <code>session</code> along as a kwarg.</li>
<li><code>SIGNAL_ACCOUNT_POST_LAST_LOGOUT</code> - fires before <code>SIGNAL_ACCOUNT_POST_LOGOUT</code>, but only if this is
  the <em>last</em> Session to disconnect for that account. Passes the <code>session</code> as a kwarg.</li>
<li><code>SIGNAL_OBJECT_POST_PUPPET</code> - fires when an account puppets this object. Extra kwargs <code>session</code>
  and <code>account</code> represent the puppeting entities.
  <code>SIGNAL_OBJECT_POST_UNPUPPET</code> - fires when the sending object is unpuppeted. Extra kwargs are
  <code>session</code> and <code>account</code>.</li>
<li><code>SIGNAL_ACCOUNT_POST_RENAME</code> - triggered by the setting of <code>Account.username</code>. Passes extra
  kwargs <code>old_name</code>, <code>new_name</code>.</li>
<li><code>SIGNAL_TYPED_OBJECT_POST_RENAME</code> - triggered when any Typeclassed entity's <code>key</code> is changed. Extra
  kwargs passed are <code>old_key</code> and <code>new_key</code>.</li>
<li><code>SIGNAL_SCRIPT_POST_CREATE</code> - fires when a script is first created, after any hooks.</li>
<li><code>SIGNAL_CHANNEL_POST_CREATE</code> - fires when a Channel is first created, after any hooks.</li>
<li><code>SIGNAL_HELPENTRY_POST_CREATE</code> - fires when a help entry is first created.</li>
</ul>
<p>The <code>evennia.signals</code> module also gives you conveneient access to the default Django signals (these use a
different naming convention).</p>
<ul>
<li><code>pre_save</code> - fired when any database entitiy's <code>.save</code> method fires, before any saving has happened.</li>
<li><code>post_save</code> - fires after saving a database entity.</li>
<li><code>pre_delete</code> - fires just before a database entity is deleted.</li>
<li><code>post_delete</code> - fires after a database entity was deleted.</li>
<li><code>pre_init</code> - fires before a typeclass' <code>__init__</code> method (which in turn
  happens before the <code>at_init</code> hook fires).</li>
<li><code>post_init</code> - triggers at the end of <code>__init__</code>  (still before the <code>at_init</code> hook).</li>
</ul>
<p>These are highly specialized Django signals that are unlikely to be useful to most users. But
they are included here for completeness.</p>
<ul>
<li><code>m2m_changed</code> - fires after a Many-to-Many field (like <code>db_attributes</code>) changes.</li>
<li><code>pre_migrate</code> - fires before database migration starts with <code>evennia migrate</code>.</li>
<li><code>post_migrate</code> - fires after database migration finished.</li>
<li><code>request_started</code> - sent when HTTP request begins.</li>
<li><code>request_finished</code> - sent when HTTP request ends.</li>
<li><code>settings_changed</code> - sent when changing settings due to <code>@override_settings</code>
  decorator (only relevant for unit testing)</li>
<li><code>template_rendered</code> - sent when test system renders http template (only useful for unit tests).</li>
<li><code>connection_creation</code> - sent when making initial connection to database.</li>
</ul></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = ".",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="js/base.js" defer></script>
        <script src="search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>

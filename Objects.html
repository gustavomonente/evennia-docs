<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="./img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Objects - Evennia Manual</title>
    <link href="./css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="./css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="./css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="./css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="./js/jquery-3.2.1.min.js"></script>
    <script src="./js/bootstrap-3.3.7.min.js"></script>
    <script src="./js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '.';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "How to create your own object types", url: "#_top", children: [
          ]},
          {title: "Properties and functions on Objects", url: "#properties-and-functions-on-objects", children: [
          ]},
          {title: "Subclasses of Object", url: "#subclasses-of-object", children: [
              {title: "Characters", url: "#characters" },
              {title: "Rooms", url: "#rooms" },
              {title: "Exits", url: "#exits" },
          ]},
        ];

    </script>
    <script src="./js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    

    <p>All in-game objects in Evennia, be it characters, chairs, monsters, rooms or hand grenades are represented by an Evennia <em>Object</em>. Objects form the core of Evennia and is probably what you'll spend most time working with. Objects are <a href="Typeclasses.html">Typeclassed</a> entities.</p>
<h2 id="how-to-create-your-own-object-types">How to create your own object types<a class="headerlink" href="#how-to-create-your-own-object-types" title="Permanent link">&para;</a></h2>
<p>An Evennia Object is, per definition, a Python class that includes <code>evennia.DefaultObject</code> among its parents. In <code>mygame/typeclasses/objects.py</code> there is already a class <code>Object</code> that inherits from <code>DefaultObject</code> and that you can inherit from. You can put your new typeclass directly in that module or you could organize your code in some other way. Here we assume we make a new module <code>mygame/typeclasses/flowers.py</code>:</p>
<pre><code class="python">    # mygame/typeclasses/flowers.py

    from typeclasses.objects import Object

    class Rose(Object):
        &quot;&quot;&quot;
        This creates a simple rose object        
        &quot;&quot;&quot;    
        def at_object_creation(self):
            &quot;this is called only once, when object is first created&quot;
            # add a persistent attribute 'desc' 
            # to object (silly example).
            self.db.desc = &quot;This is a pretty rose with thorns.&quot;     
</code></pre>

<p>You could save this in the <code>mygame/typeclasses/objects.py</code> (then you'd not need to import <code>Object</code>) or you can put it in a new module. Let's say we do the latter, making a module <code>typeclasses/flowers.py</code>.  Now you just need to point to the class <em>Rose</em> with the <code>@create</code> command to make a new rose:</p>
<pre><code> @create/drop MyRose:flowers.Rose
</code></pre>
<p>What the <code>@create</code> command actually <em>does</em> is to use <code>evennia.create_object</code>. You can do the same thing yourself in code:</p>
<pre><code class="python">    from evennia import create_object
    new_rose = create_object(&quot;typeclasses.flowers.Rose&quot;, key=&quot;MyRose&quot;)
</code></pre>

<p>(The <code>@create</code> command will auto-append the most likely path to your typeclass, if you enter the call manually you have to give the full path to the class. The <code>create.create_object</code> function is powerful and should be used for all coded object creating (so this is what you use when defining your own building commands). Check out the <code>ev.create_*</code> functions for how to build other entities like <a href="Scripts.html">Scripts</a>). </p>
<p>This particular Rose class doesn't really do much, all it does it make sure the attribute <code>desc</code>(which is what the <code>look</code> command looks for) is pre-set, which is pretty pointless since you will usually want to change this at build time (using the <code>@desc</code> command or using the <a href="https://github.com/evennia/evennia/wiki/Spawner-and-Prototypes">Spawner</a>). The <code>Object</code> typeclass offers many more hooks that is available to use though - see next section. </p>
<h2 id="properties-and-functions-on-objects">Properties and functions on Objects<a class="headerlink" href="#properties-and-functions-on-objects" title="Permanent link">&para;</a></h2>
<p>Beyond the properties assigned to all <a href="Typeclasses.html">typeclassed</a> objects (see that page for a list of those), the Object also has the following custom properties: </p>
<ul>
<li><code>aliases</code> - a handler that allows you to add and remove aliases from this object. Use <code>aliases.add()</code> to add a new alias and <code>aliases.remove()</code> to remove one. </li>
<li><code>location</code> - a reference to the object currently containing this object.</li>
<li><code>home</code> is a backup location. The main motivation is to have a safe place to move the object to if its <code>location</code> is destroyed. All objects should usually have a home location for safety.</li>
<li><code>destination</code> - this holds a reference to another object this object links to in some way. Its main use is for <a href="Objects#Exits">Exits</a>, it's otherwise usually unset.</li>
<li><code>nicks</code> - as opposed to aliases, a <a href="Nicks.html">Nick</a> holds a convenient nickname replacement for a real name, word or sequence, only valid for this object. This mainly makes sense if the Object is used as a game character - it can then store briefer shorts, example so as to quickly reference game commands or other characters. Use nicks.add(alias, realname) to add a new one.</li>
<li><code>account</code> - this holds a reference to a connected <a href="Accounts.html">Account</a> controlling this object (if any). Note that this is set also if the controlling account is <em>not</em> currently online - to test if an account is online, use the <code>has_account</code> property instead.</li>
<li><code>sessions</code> - if <code>account</code> field is set <em>and the account is online</em>, this is a list of all active sessions (server connections) to contact them through (it may be more than one if multiple connections are allowed in settings).</li>
<li><code>has_account</code> - a shorthand for checking if an <em>online</em> account is currently connected to this object.</li>
<li><code>contents</code> - this returns a list referencing all objects 'inside' this object (i,e. which has this object set as their <code>location</code>).</li>
<li><code>exits</code> - this returns all objects inside this object that are <em>Exits</em>, that is, has the <code>destination</code> property set.</li>
</ul>
<p>The last two properties are special:</p>
<ul>
<li><code>cmdset</code> - this is a handler that stores all <a href="Commands#Command_Sets">command sets</a> defined on the object (if any).</li>
<li><code>scripts</code> - this is a handler that manages Scripts.md attached to the object (if any).</li>
</ul>
<p>The Object also has a host of useful utility functions. See the function headers in <code>src/objects/objects.py</code> for their arguments and more details. </p>
<ul>
<li><code>msg()</code> - this function is used to send messages from the server to an account connected to this object.</li>
<li><code>msg_contents()</code> - calls <code>msg</code> on all objects inside this object.</li>
<li><code>search()</code> - this is a convenient shorthand to search for a specific object, at a given location or globally. It's mainly useful when defining commands (in which case the object executing the command is named <code>caller</code> and one can do <code>caller.search()</code> to find objects in the room to operate on).</li>
<li><code>execute_cmd()</code> - Lets the object execute the given string as if it was given on the command line.</li>
<li><code>move_to</code> - perform a full move of this object to a new location.  This is the main move method and will call all relevant hooks, do all checks etc.</li>
<li><code>clear_exits()</code> - will delete all <a href="Objects#Exits">Exits</a> to <em>and</em> from this object.</li>
<li><code>clear_contents()</code> - this will not delete anything, but rather move all contents (except Exits) to their designated <code>Home</code> locations.</li>
<li><code>delete()</code> - deletes this object, first calling <code>clear_exits()</code> and
    <code>clear_contents()</code>.</li>
</ul>
<p>The Object Typeclass defines many more <em>hook methods</em> beyond <code>at_object_creation</code>. Evennia calls these hooks at various points.  When implementing your custom objects, you will inherit from the base parent and overload these hooks with your own custom code. See <code>evennia.objects.objects</code> for an updated list of all the available hooks or the <a href="evennia.objects.objects#defaultobject">API for DefaultObject here</a>.</p>
<h2 id="subclasses-of-object">Subclasses of <code>Object</code><a class="headerlink" href="#subclasses-of-object" title="Permanent link">&para;</a></h2>
<p>There are three special subclasses of <em>Object</em> in default Evennia - <em>Characters</em>, <em>Rooms</em> and <em>Exits</em>. The reason they are separated is because these particular object types are fundamental, something you will always need and in some cases requires some extra attention in order to be recognized by the game engine (there is nothing stopping you from redefining them though). In practice they are all pretty similar to the base Object.  </p>
<h3 id="characters">Characters<a class="headerlink" href="#characters" title="Permanent link">&para;</a></h3>
<p>Characters are objects controlled by <a href="Accounts.html">Accounts</a>. When a new Account
logs in to Evennia for the first time, a new <code>Character</code> object is created and
the Account object is assigned to the <code>account</code> attribute. A <code>Character</code> object
must have a <a href="Commands#Command_Sets">Default Commandset</a> set on itself at
creation, or the account will not be able to issue any commands! If you just
inherit your own class from <code>evennia.DefaultCharacter</code> and make sure to use
<code>super()</code> to call the parent methods you should be fine. In
<code>mygame/typeclasses/characters.py</code> is an empty <code>Character</code> class ready for you
to modify.</p>
<h3 id="rooms">Rooms<a class="headerlink" href="#rooms" title="Permanent link">&para;</a></h3>
<p><em>Rooms</em> are the root containers of all other objects. The only thing really separating a room from any other object is that they have no <code>location</code> of their own and that default commands like <code>@dig</code> creates objects of this class - so if you want to expand your rooms with more functionality, just inherit from <code>ev.DefaultRoom</code>. In <code>mygame/typeclasses/rooms.py</code> is an empty <code>Room</code> class ready for you to modify.</p>
<h3 id="exits">Exits<a class="headerlink" href="#exits" title="Permanent link">&para;</a></h3>
<p><em>Exits</em> are objects connecting other objects (usually <em>Rooms</em>) together. An object named <em>North</em> or <em>in</em> might be an exit, as well as <em>door</em>, <em>portal</em> or <em>jump out the window</em>. An exit has two things that separate them from other objects. Firstly, their <em>destination</em> property is set and points to a valid object. This fact makes it easy and fast to locate exits in the database. Secondly, exits define a special <a href="Commands.html">Transit Command</a> on themselves when they are created. This command is named the same as the exit object and will, when called, handle the practicalities of moving the character to the Exits's <em>destination</em> - this allows you to just enter the name of the exit on its own to move around, just as you would expect. </p>
<p>The exit functionality is all defined on the Exit typeclass, so you could in principle completely change how exits work in your game (it's not recommended though, unless you really know what you are doing).  Exits are <a href="Locks.html">locked</a> using an access_type called <em>traverse</em> and also make use of a few hook methods for giving feedback if the traversal fails.  See <code>evennia.DefaultExit</code> for more info.  In <code>mygame/typeclasses/exits.py</code> there is an empty <code>Exit</code> class for you to modify.</p>
<p>The process of traversing an exit is as follows:</p>
<ol>
<li>The traversing <code>obj</code> sends a command that matches the Exit-command name on the Exit object. The <a href="Commands.html">cmdhandler</a> detects this and triggers the command defined on the Exit. Traversal always involves the "source" (the current location) and the <code>destination</code> (this is stored on the Exit object). </li>
<li>The Exit command checks the <code>traverse</code> lock on the Exit object</li>
<li>The Exit command triggers <code>at_traverse(obj, destination)</code> on the Exit object.</li>
<li>In <code>at_traverse</code>, <code>object.move_to(destination)</code> is triggered. This triggers the following hooks, in order:<ol>
<li><code>obj.at_before_move(destination)</code> - if this returns False, move is aborted.</li>
<li><code>origin.at_before_leave(obj, destination)</code></li>
<li><code>obj.announce_move_from(destination)</code></li>
<li>Move is performed by changing <code>obj.location</code> from source location to <code>destination</code>.</li>
<li><code>obj.announce_move_to(source)</code></li>
<li><code>destination.at_object_receive(obj, source)</code></li>
<li><code>obj.at_after_move(source)</code></li>
</ol>
</li>
<li>On the Exit object, <code>at_after_traverse(obj, source)</code> is triggered.</li>
</ol>
<p>If the move fails for whatever reason, the Exit will look for an Attribute <code>err_traverse</code> on itself and display this as an error message. If this is not found, the Exit will instead call
<code>at_failed_traverse(obj)</code> on itself. </p>

  <br>
    

    <br>
</div>

<footer class="col-md-12 wm-page-content">
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>
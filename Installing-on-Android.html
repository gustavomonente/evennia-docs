<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="img/favicon.ico">
        <title>Installing on Android - Evennia Manual</title>
        <link href="css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="css/font-awesome.min.css" rel="stylesheet">
        <link href="css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="js/jquery-1.10.2.min.js" defer></script>
        <script src="js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="index.html">Evennia Manual</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="index.html">Home</a>
                            </li>
                            <li >
                                <a href="Administrative-Docs.html">Admin</a>
                            </li>
                            <li >
                                <a href="Builder-Docs.html">Building</a>
                            </li>
                            <li >
                                <a href="Developer-Central.html">Game Development</a>
                            </li>
                            <li >
                                <a href="Tutorials.html">Tutorials</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#install-termux">Install Termux</a></li>
        <li class="main "><a href="#prerequisites">Prerequisites</a></li>
            <li><a href="#installing-evennia">Installing Evennia</a></li>
            <li><a href="#final-steps">Final steps</a></li>
        <li class="main "><a href="#running-evennia">Running Evennia</a></li>
        <li class="main "><a href="#caveats">Caveats</a></li>
        <li class="main "><a href="#troubleshooting">Troubleshooting</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<p>This page describes how to install and run the Evennia server on an Android phone. This will involve
installing a slew of third-party programs from the Google Play store, so make sure you are okay with
this before starting.</p>
<h2 id="install-termux">Install Termux<a class="headerlink" href="#install-termux" title="Permanent link">&para;</a></h2>
<p>The first thing to do is install a terminal emulator that allows a "full" version of linux to be run. Note that Android is essentially running on top of linux so if you have a rooted phone, you may be able to skip this step. You <em>don't</em> require a rooted phone to install Evennia though.</p>
<p>Assuming we do not have root, we will install <a href="https://play.google.com/store/apps/details?id=com.termux&amp;hl=en">Termux</a>.
Termux provides a base installation of Linux essentials, including apt and Python, and makes them available under a writeable directory. It also gives us a terminal where we can enter commands. By default, Android doesn't give you permissions to the root folder, so Termux pretends that its own installation directory is the root directory.</p>
<p>Termux will set up a base system for us on first launch, but we will need to install some prerequisites for Evennia. Commands you should run in Termux will look like this:</p>
<pre><code>$ cat file.txt
</code></pre>

<p>The <code>$</code> symbol is your prompt - do not include it when running commands.</p>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h2>
<p>To install some of the libraries Evennia requires, namely Pillow and Twisted, we have to first install some packages they depend on. In Termux, run the following </p>
<pre><code>$ pkg install -y clang git zlib ndk-sysroot libjpeg-turbo libcrypt python
</code></pre>

<p>Termux ships with Python 3, perfect. Python 3 has venv (virtualenv) and pip (Python's module installer) built-in.</p>
<p>So, let's set up our virtualenv. This keeps the Python packages we install separate from the system versions.</p>
<pre><code>$ cd
$ python3 -m venv evenv
</code></pre>

<p>This will create a new folder, called <code>evenv</code>, containing the new python executable.
Next, let's activate our new virtualenv. Every time you want to work on Evennia, you need to run the following command:</p>
<pre><code>$ source evenv/bin/activate
</code></pre>

<p>Your prompt will change to look like this:</p>
<pre><code>(evenv) $
</code></pre>

<p>Update the updaters and installers in the venv: pip, setuptools and wheel.</p>
<pre><code>python3 -m pip install --upgrade pip setuptools wheel
</code></pre>

<h3 id="installing-evennia">Installing Evennia<a class="headerlink" href="#installing-evennia" title="Permanent link">&para;</a></h3>
<p>Now that we have everything in place, we're ready to download and install Evennia itself.</p>
<p>Mysterious incantations</p>
<pre><code>export LDFLAGS=&quot;-L/data/data/com.termux/files/usr/lib/&quot;
export CFLAGS=&quot;-I/data/data/com.termux/files/usr/include/&quot;
</code></pre>

<p>(these tell clang, the C compiler, where to find the bits for zlib when building Pillow)</p>
<p>Install the latest Evennia in a way that lets you edit the source</p>
<pre><code>(evenv) $ pip install --upgrade -e 'git+https://github.com/evennia/evennia#egg=evennia' 
</code></pre>

<p>This step will possibly take quite a while - we are downloading Evennia and are then installing it, building all of the requirements for Evennia to run. If you run into trouble on this step, please see <a href="#troubleshooting">Troubleshooting</a>.</p>
<p>You can go to the dir where Evennia is installed with <code>cd $VIRTUAL_ENV/src/evennia</code>. <code>git grep (something)</code> can be handy, as can <code>git diff</code></p>
<h3 id="final-steps">Final steps<a class="headerlink" href="#final-steps" title="Permanent link">&para;</a></h3>
<p>At this point, Evennia is installed on your phone! You can now continue with the original <a href="Getting-Started">Getting Started</a> instruction, we repeat them here for clarity.</p>
<p>To start a new game:</p>
<pre><code>(evenv) $ evennia --init mygame
(evenv) $ ls
mygame evenv
</code></pre>

<p>To start the game for the first time:</p>
<pre><code>(evenv) $ cd mygame
(evenv) $ evennia migrate
(evenv) $ evennia start
</code></pre>

<p>Your game should now be running! Open a web browser at http://localhost:4001 or point a telnet client to localhost:4000 and log in with the user you created.</p>
<h2 id="running-evennia">Running Evennia<a class="headerlink" href="#running-evennia" title="Permanent link">&para;</a></h2>
<p>When you wish to run Evennia, get into your Termux console and make sure you have activated your virtualenv as well as are in your game's directory. You can then run evennia start as normal.</p>
<pre><code>$ cd ~ &amp;&amp; source evenv/bin/activate
(evenv) $ cd mygame
(evenv) $ evennia start
</code></pre>

<p>You may wish to look at the <a href="https://github.com/evennia/evennia/wiki/Getting-Started#linux-install">Linux Instructions</a> for more.</p>
<h2 id="caveats">Caveats<a class="headerlink" href="#caveats" title="Permanent link">&para;</a></h2>
<ul>
<li>Android's os module doesn't support certain functions - in particular getloadavg. Thusly, running the command @server in-game will throw an exception. So far, there is no fix for this problem.</li>
<li>As you might expect, performance is not amazing.</li>
<li>Android is fairly aggressive about memory handling, and you may find that your server process is killed if your phone is heavily taxed. Termux seems to keep a notification up to discourage this.</li>
</ul>
<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">&para;</a></h2>
<p>As time goes by and errors are reported, this section will be added to.</p>
<p>Some steps to try anyway:
* Make sure your packages are up-to-date, try running <code>pkg update &amp;&amp; pkg upgrade -y</code>
* Make sure you've installed the clang package. If not, try <code>pkg install clang -y</code>
* Make sure you're in the right directory. <code>cd ~/mygame
* Make sure you've sourced your virtualenv. type</code>cd &amp;&amp; source evenv/bin/activate<code>* See if a shell will start:</code>cd ~/mygame ; evennia shell`
* Look at the log files in ~/mygame/server/logs/</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = ".",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="js/base.js" defer></script>
        <script src="search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
